<!-- Message bubble component - used for both initial render and HTMX updates -->
{% if message.role == 'user' or message.role == 'USER' %}
    <!-- User message (right-aligned, blue) -->
    <div class="flex justify-end message-enter">
        <div class="max-w-[70%] bg-blue-600 text-white rounded-lg px-4 py-3">
            <p class="whitespace-pre-wrap">{{ message.content }}</p>
            {% if message.timestamp %}
            <p class="text-xs text-blue-100 mt-1 opacity-75">
                {{ message.timestamp.strftime('%I:%M %p') if message.timestamp else '' }}
            </p>
            {% endif %}
        </div>
    </div>

{% elif message.role == 'assistant' or message.role == 'ASSISTANT' %}
    <!-- Assistant message (left-aligned, gray) -->
    <div class="flex justify-start message-enter">
        <div class="max-w-[70%] bg-gray-100 text-gray-900 rounded-lg px-4 py-3">
            <div class="flex items-start gap-2">
                <span class="text-2xl">ðŸ©º</span>
                <div class="flex-1">
                    <p class="whitespace-pre-wrap">{{ message.content }}</p>
                    {% if message.timestamp %}
                    <p class="text-xs text-gray-500 mt-1">
                        {{ message.timestamp.strftime('%I:%M %p') if message.timestamp else '' }}
                        {% if message.response_time_ms %}
                        â€¢ {{ (message.response_time_ms / 1000) | round(1) }}s
                        {% endif %}
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

{% elif message.role == 'system' or message.role == 'SYSTEM' %}
    <!-- System message (centered, subtle) -->
    <div class="flex justify-center">
        <div class="max-w-[70%] bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-lg px-4 py-2 text-sm">
            <p class="text-center">{{ message.content }}</p>
        </div>
    </div>

{% endif %}
